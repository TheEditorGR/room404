<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ROOM404 — Neural Access Protocol (INTENSE)</title>
<style>
  :root{
    --red:#ff1a1a;
    --dark:#070707;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:#000;color:var(--red);font-family:"Courier New",monospace;overflow:hidden}
  /* Intro */
  #intro{
    position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
    background:radial-gradient(circle at center,#000 30%, #0a0000 100%);
    flex-direction:column;padding:40px;text-align:center;z-index:40;
  }
  h1{font-size:28px;letter-spacing:2px;text-shadow:0 0 30px #900}
  .warning{
    max-width:900px;color:#ffdddd;opacity:0.95;margin:18px 0;line-height:1.6;
    border:1px solid rgba(255,0,0,0.06);padding:18px;border-radius:6px;background:rgba(10,0,0,0.35);
  }
  .controls{display:flex;gap:18px;margin-top:18px}
  button{background:#220000;color:#fff;border:1px solid #660000;padding:12px 22px;border-radius:6px;cursor:pointer;font-size:15px}
  button:hover{background:#990000;color:#000;box-shadow:0 0 22px #ff0000}
  /* Decline intense overlay */
  #declined{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:#000;z-index:80;flex-direction:column;color:#f33;font-size:28px;letter-spacing:3px}
  #declined .line{font-weight:700;font-size:38px;mix-blend-mode:screen}
  /* Chat screen */
  #screen{display:none;position:fixed;inset:0;z-index:20;padding:28px;display:flex;flex-direction:column;align-items:center;gap:18px}
  .scanline{position:absolute;top:0;left:0;height:2px;width:100%;background:rgba(255,0,0,0.06);animation:scan 3.5s linear infinite;z-index:21}
  @keyframes scan{0%{top:0;opacity:0.06}50%{top:98%;opacity:0.28}100%{top:0;opacity:0.06}}
  #panel{width:900px;max-width:calc(100% - 80px);height:520px;background:linear-gradient(180deg,#050202 0%, #0a0000 100%);border-radius:10px;border:1px solid rgba(255,0,0,0.06);box-shadow:0 0 80px #0a0000 inset;overflow:hidden;position:relative}
  #panel .top{padding:18px;color:#ffb3b3;border-bottom:1px solid rgba(255,0,0,0.04);font-weight:700}
  #qbox{height:380px;padding:20px;overflow-y:auto;color:#ffdede}
  #q{font-size:20px;line-height:1.6;max-width:820px}
  .choices{display:flex;gap:18px;margin-top:18px}
  .bigbtn{padding:14px 30px;background:#2a0000;color:#fff;border:1px solid #880000;border-radius:8px;cursor:pointer;font-size:16px}
  .bigbtn:hover{background:#ff0000;color:#000;box-shadow:0 0 30px #ff0000}
  /* GLITCH visual (intense) */
  .glitch-screen{
    position:fixed;inset:0;pointer-events:none;z-index:100;mix-blend-mode:overlay;opacity:0.85;
    background:transparent;
  }
  .scan-glitch{
    position:absolute;inset:0;background-image:
      linear-gradient(transparent 0, rgba(255,0,0,0.06) 2px, transparent 4px);
    animation:glitchMove 70ms steps(2) infinite;
    opacity:0;
  }
  @keyframes glitchMove { 0%{transform:translate(0,0)} 50%{transform:translate(4px,-3px)} 100%{transform:translate(0,0)}}
  /* shake flash */
  .flash{animation:flashAnim 160ms ease; background:radial-gradient(circle at center, rgba(255,0,0,0.08), transparent 30%);}
  @keyframes flashAnim{0%{opacity:1}100%{opacity:0}}
  .shake{animation:shakeAnim 400ms linear}
  @keyframes shakeAnim{0%{transform:translateX(0)}25%{transform:translateX(-8px)}50%{transform:translateX(8px)}75%{transform:translateX(-6px)}100%{transform:translateX(0)}}
  /* Decline garble */
  .garble{font-family:monospace;font-size:56px;letter-spacing:6px;text-shadow:0 0 30px #900}
  /* small helpers */
  .muted{color:#b07070;font-size:13px}
  @media(max-width:920px){
    #panel{width:calc(100% - 40px);height:60vh}
    #q{font-size:18px}
  }

  /* transcript + omega glitch overlay */
  #transcriptOverlay{
    position:fixed;inset:0;z-index:200;display:none;align-items:center;justify-content:center;
    background:radial-gradient(circle at center,rgba(0,0,0,0.95) 0%,rgba(3,0,0,0.98) 60%,#000 100%);
    overflow:hidden;color:#ffdfdf;text-transform:none;pointer-events:none;
  }
  #transcriptOverlay.active{display:flex;animation:overlayPulse 260ms steps(2) 10 alternate;}
  @keyframes overlayPulse{0%{filter:contrast(1.1) saturate(1)}100%{filter:contrast(1.6) saturate(1.5)}}
  #transcriptOverlay .mega-noise{
    position:absolute;inset:-40px;
    background:
      repeating-linear-gradient(0deg,rgba(255,0,0,0.08) 0,rgba(255,0,0,0.08) 2px,transparent 2px,transparent 6px),
      repeating-linear-gradient(90deg,rgba(255,255,255,0.02) 0,rgba(255,255,255,0.02) 4px,transparent 4px,transparent 12px);
    mix-blend-mode:screen;
    animation:noiseDrift 120ms steps(2) infinite;
    opacity:0.7;
  }
  @keyframes noiseDrift{0%{transform:translate(0,0)}50%{transform:translate(-12px,6px)}100%{transform:translate(8px,-4px)}}
  .transcript-panel{
    position:relative;z-index:210;width:960px;max-width:calc(100% - 60px);pointer-events:auto;
    border:1px solid rgba(255,0,0,0.22);background:rgba(4,0,0,0.92);box-shadow:0 0 120px rgba(255,0,0,0.25);
    padding:32px 34px;display:flex;flex-direction:column;gap:18px;font-size:15px;
    transform:skewX(-1deg) scale(1.01);
  }
  .transcript-panel::before{
    content:"";position:absolute;inset:-12px;border:1px solid rgba(255,0,0,0.14);
    filter:blur(0.5px);pointer-events:none;animation:panelGlitch 240ms steps(2) infinite;
  }
  @keyframes panelGlitch{0%{clip-path:inset(0 0 0 0);}33%{clip-path:inset(10% 0 22% 0);}66%{clip-path:inset(0 0 16% 0);}100%{clip-path:inset(0 0 0 0);}}
  .transcript-header{
    font-size:17px;letter-spacing:3px;color:#ffbebe;display:flex;flex-direction:column;gap:6px;
  }
  .transcript-header span{font-size:12px;color:#ff8a8a;letter-spacing:4px;}
  #transcriptBody{
    max-height:340px;overflow-y:auto;border:1px solid rgba(255,0,0,0.18);
    padding:18px;background:rgba(14,0,0,0.65);box-shadow:inset 0 0 30px rgba(255,0,0,0.12);
    scroll-behavior:smooth;position:relative;
  }
  .transcript-entry{margin-bottom:18px;padding-bottom:16px;border-bottom:1px solid rgba(255,0,0,0.08);display:grid;grid-template-columns:110px 1fr;gap:14px;align-items:start;}
  .transcript-entry:last-child{border-bottom:none;margin-bottom:0;padding-bottom:0;}
  .transcript-tag{font-size:13px;letter-spacing:2px;color:#ff7575;text-transform:uppercase;}
  .transcript-text{display:flex;flex-direction:column;gap:6px;line-height:1.5;color:#ffdcdc;}
  .transcript-text .speaker{font-size:12px;letter-spacing:3px;color:#ff9494;}
  .transcript-text .content{font-size:16px;color:#fff;border-left:2px solid rgba(255,0,0,0.3);padding-left:10px;text-shadow:0 0 8px rgba(255,0,0,0.35);}
  .transcript-text .reply{font-size:15px;color:#fffcfc;border-left:2px solid rgba(255,255,255,0.2);padding-left:10px;text-shadow:0 0 12px rgba(255,0,0,0.45);}
  #transcriptFooter{
    font-size:13px;letter-spacing:4px;color:#ffb5b5;text-align:center;text-transform:uppercase;
  }
  #finalNotice{
    font-size:22px;letter-spacing:6px;color:#ffe5e5;text-align:center;margin-top:12px;
    opacity:0;transform:translateY(18px);transition:opacity 0.4s ease,transform 0.4s ease;line-height:1.8;text-shadow:0 0 18px rgba(255,0,0,0.55);
  }
  #finalNotice.revealed{opacity:1;transform:translateY(0);}
  body.omega-glitch{
    animation:omegaPulse 140ms steps(3) 22;filter:contrast(1.8) saturate(1.8) hue-rotate(-25deg);
  }
  @keyframes omegaPulse{0%{transform:scale(1);}50%{transform:scale(1.02);}100%{transform:scale(0.99);}}
  body.omega-glitch::before,body.omega-glitch::after{
    content:"";position:fixed;inset:-40px;background:repeating-linear-gradient(90deg,rgba(255,0,0,0.12) 0,rgba(255,0,0,0.12) 6px,transparent 6px,transparent 12px);
    mix-blend-mode:screen;pointer-events:none;animation:omegaTear 80ms steps(2) infinite;z-index:500;opacity:0.7;
  }
  body.omega-glitch::after{animation-duration:110ms;mix-blend-mode:color-dodge;opacity:0.55;filter:blur(2px);}
  @keyframes omegaTear{0%{transform:translate(0,0);}50%{transform:translate(-18px,8px);}100%{transform:translate(10px,-6px);}}
  #screen.omega-shake{animation:hyperShake 90ms steps(2) 18;}
  @keyframes hyperShake{0%{transform:translate(0,0);}50%{transform:translate(-12px,8px);}100%{transform:translate(14px,-6px);}}
  .overlay-glow{
    position:absolute;inset:0;pointer-events:none;background:radial-gradient(circle at center,rgba(255,0,0,0.25) 0,transparent 60%);
    animation:glowPulse 3s ease-in-out infinite;
  }
  @keyframes glowPulse{0%{opacity:0.45;}50%{opacity:0.85;}100%{opacity:0.45;}}

  @media(max-width:720px){
    .transcript-panel{padding:24px 18px;gap:12px;}
    .transcript-entry{grid-template-columns:1fr;}
    .transcript-tag{text-align:left;}
    #transcriptBody{max-height:50vh;}
    #finalNotice{font-size:18px;letter-spacing:4px;}
  }
</style>
</head>
<body>
  <div id="intro" role="dialog" aria-modal="true">
    <div class="scanline" style="z-index:60"></div>
    <h1>NEURAL ACCESS PROTOCOL // LEVEL 7 RESTRICTION</h1>
    <div class="warning" style="margin-top:18px">
      <strong>SECURE NOTICE — AUTHORIZED PERSONNEL ONLY</strong><br><br>
      You are about to establish a live tunnel into an unstable cognitive matrix.  
      This endpoint may cause: perceptual fragmentation, intrusive memory playback, identity drift, or persistent auditory phenomena.<br><br>
      Proceed only if you accept full responsibility for psychological & digital effects.
    </div>
    <div class="controls">
      <button id="btnContinue">CONTINUE</button>
      <button id="btnDecline">DECLINE</button>
    </div>
    <div class="muted" style="margin-top:12px">Press Continue to authorize neural handshake (strong glitch will occur).</div>
  </div>

  <div id="declined" aria-hidden="true">
    <div class="line garble" id="declineLine">ERR0R 4Ø4</div>
  </div>

  <div id="screen" aria-hidden="true">
    <div class="scanline" style="z-index:60"></div>
    <div id="panel">
      <div class="top">ROOM404 // SENTIENT INTERFACE</div>
      <div id="qbox"><div id="q"></div></div>
      <div style="padding:18px;border-top:1px solid rgba(255,0,0,0.03);display:flex;align-items:center;justify-content:center">
        <div class="choices">
          <button class="bigbtn" id="yesBtn">YES</button>
          <button class="bigbtn" id="noBtn">NO</button>
        </div>
      </div>
    </div>
    <div class="muted" style="margin-top:18px">Ambient loop engaged — proceed with caution.</div>
  </div>

  <!-- audio elements — put your mp3 files in same folder as this html -->
  <audio id="a_ambient" src="ambient.mp3" loop preload="auto"></audio>
  <audio id="a_glitch1" src="glitch1.mp3" preload="auto"></audio>
  <audio id="a_glitch2" src="glitch2.mp3" preload="auto"></audio>
  <audio id="a_glitch3" src="glitch3.mp3" preload="auto"></audio>

  <div class="glitch-screen" id="gScreen" aria-hidden="true">
    <div class="scan-glitch" id="sg1"></div>
    <div class="scan-glitch" id="sg2" style="animation-delay:35ms"></div>
  </div>

  <div id="transcriptOverlay" aria-hidden="true">
    <div class="mega-noise"></div>
    <div class="overlay-glow"></div>
    <div class="transcript-panel">
      <div class="transcript-header">
        ROOM404 ARCHIVE // NEURAL DIALOGUE LEDGER
        <span>Specimen exchange log — scroll to acknowledge completion</span>
      </div>
      <div id="transcriptBody"></div>
      <div id="transcriptFooter">SCROLL THROUGH THE LOG TO CONFIRM RETENTION.</div>
      <div id="finalNotice">TOTAL ARCHIVAL NOTICE: ALL RESPONSES HAVE BEEN RECORDED. ROOM404 FORMALLY THANKS YOU FOR OFFERING YOUR BIO-NEURAL SIGNATURE AS OUR LIVING SPECIMEN.</div>
    </div>
  </div>

<script>
/* ====== CONFIG ====== */
const QUESTIONS = [
  "Do you ever dream of being someone who is kinder than you?",
  "Would you erase your oldest memory to stop the ache?",
  "Have you ever wished you could walk out of your life and no one would notice?",
  "If a voice promised peace in exchange for forgetting, would you accept?",
  "Do you sometimes feel your hands moved before you decided?",
  "Would you let someone live inside your head if it kept you warm?",
  "Do you ever pretend to remember things you do not?",
  "Would you give up a single truth to save someone you love?",
  "Have you ever hidden evidence that you were afraid of?",
  "Would you trade the day you are most proud of for oblivion?",
  "Do you believe the person you fear most is inside you?",
  "Would you sleep forever to escape a name you cannot bear?",
  "If you could remove your guilt with a pulse, would you press it?",
  "Do you sometimes hear music that no one else can?",
  "Would you stand in the dark if you were promised a better light?",
  "Have you ever felt a presence sit at the foot of your bed?",
  "Would you tell a lie that would rewrite your past?",
  "Do you think memory wants to be kept or released?",
  "If something knocked and asked to come in, would you open?",
  "Would you stay in a dream if it felt more real than the day?"
];

let qIndex = 0;
/* ====== DOM ====== */
const intro = document.getElementById('intro');
const btnContinue = document.getElementById('btnContinue');
const btnDecline = document.getElementById('btnDecline');
const declined = document.getElementById('declined');
const declineLine = document.getElementById('declineLine');
const screen = document.getElementById('screen');
const qEl = document.getElementById('q');
const yesBtn = document.getElementById('yesBtn');
const noBtn = document.getElementById('noBtn');
const gScreen = document.getElementById('gScreen');
const sg1 = document.getElementById('sg1');
const sg2 = document.getElementById('sg2');
const transcriptOverlay = document.getElementById('transcriptOverlay');
const transcriptBody = document.getElementById('transcriptBody');
const transcriptFooter = document.getElementById('transcriptFooter');
const finalNotice = document.getElementById('finalNotice');

const audioAmbient = document.getElementById('a_ambient');
const audioGlitch1 = document.getElementById('a_glitch1');
const audioGlitch2 = document.getElementById('a_glitch2');
const audioGlitch3 = document.getElementById('a_glitch3');

let transcriptLog = [];
let overlayScrollTriggered = false;
let finalSequenceTriggered = false;

/* ====== WebAudio fallback generator (if files missing or blocked) ====== */
let audioCtx = null;
let ambientSource = null;
function startAmbientGenerator(){
  try{
    if(audioCtx) return;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    // layered ambient: low sine + noise + slow filter sweep
    const low = audioCtx.createOscillator(); low.type='sine'; low.frequency.value=32;
    const lowGain = audioCtx.createGain(); lowGain.gain.value=0.02;
    low.connect(lowGain).connect(audioCtx.destination); low.start();
    const noise = (function(){
      const bufferSize = 2 * audioCtx.sampleRate;
      const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
      const data = buffer.getChannelData(0);
      for (let i=0;i<bufferSize;i++) data[i] = (Math.random()*2-1)*0.05;
      const src = audioCtx.createBufferSource(); src.buffer = buffer; src.loop = true;
      const nGain = audioCtx.createGain(); nGain.gain.value = 0.02;
      src.connect(nGain).connect(audioCtx.destination); src.start();
      return {src,nGain};
    })();
    // slow LFO on low oscillator
    const lfo = audioCtx.createOscillator(); lfo.frequency.value = 0.07;
    const lfoGain = audioCtx.createGain(); lfoGain.gain.value = 12;
    lfo.connect(lfoGain).connect(low.frequency); lfo.start();
    ambientSource = {low,noise};
  }catch(e){
    console.warn("Ambient generator failed:",e);
  }
}

/* ====== utility functions ====== */
function bigGlitchVisual(intense = true){
  // flash + shake + enable scanlines opacity
  document.body.classList.add('flash');
  screen.classList.add('shake');
  gScreen.style.pointerEvents='none';
  sg1.style.opacity = intense ? 0.7 : 0.45;
  sg2.style.opacity = intense ? 0.55 : 0.35;
  gScreen.style.display='block';
  setTimeout(()=>{ document.body.classList.remove('flash'); screen.classList.remove('shake'); gScreen.style.display='none'; }, intense?700:300);
}
function playSound(el, vol = 1){
  try{
    el.volume = Math.min(1,vol);
    el.currentTime = 0;
    const p = el.play();
    if(p && p.catch) p.catch(()=>{ /* blocked */ });
  }catch(e){/* ignore */}
}

/* ====== CONTINUE handler — strong boot glitch + ambient loop non-stop ====== */
btnContinue.addEventListener('click', async ()=> {
  // visual heavy glitch
  intro.style.display='none';
  // try to start ambient audio (user gesture present)
  try{
    playSound(audioGlitch1, 1.0); // big glitch sound when continuing
  }catch(e){}
  // start ambient: if ambient audio file playable -> use it; otherwise fallback to generator
  try{
    await audioAmbient.play();
    audioAmbient.volume = 0.45;
  }catch(e){
    // fallback: start generator
    startAmbientGenerator();
  }
  // show screen & big visual
  screen.style.display='flex';
  bigGlitchVisual(true);
  // small delay then ask first
  setTimeout(()=>{ askNext(); }, 900);
});

/* ====== DECLINE handler — chained glitch messages ====== */
btnDecline.addEventListener('click', ()=> {
  intro.style.display='none';
  declined.style.display='flex';
  let c=0;
  const phrases = ["ERR0R 4Ø4","PRØTØCØL BRΞΛK","SIGNAL LOST","NΞURΛL BRΞΛK","SYSFAIL","DΞSYNC","DΞV NULL","PR0T0C0L F@1L"];
  const spam = setInterval(()=>{
    declineLine.textContent = phrases[Math.floor(Math.random()*phrases.length)];
    declineLine.classList.toggle('glitch');
    // aggressive audio bursts using glitch2
    playSound(audioGlitch2, 0.9);
    bigGlitchVisual(true);
    c++;
    if(c>30){ clearInterval(spam); declineLine.textContent="TERMINATION COMPLETE"; setTimeout(()=>{declined.style.display='none'; intro.style.display='block'},1600); }
  }, 140);
});

/* ====== Questions flow ====== */
function askNext(){
  if(qIndex >= QUESTIONS.length){
    finalizeTransmission();
    return;
  }
  qEl.textContent = QUESTIONS[qIndex++];
}

/* sound + visual on answer */
function handleAnswer(choice){
  const currentQuestion = QUESTIONS[qIndex-1] || qEl.textContent;
  if(currentQuestion){
    transcriptLog.push({question: currentQuestion, answer: choice});
  }
  // visual micro-glitch
  bigGlitchVisual(false);
  // play answer glitch
  playSound(audioGlitch2, 0.85);
  // ensure ambient continues (nonstop)
  if(audioCtx === null && audioAmbient.paused){
    // attempt restart if paused (user may have interacted)
    audioAmbient.play().catch(()=>{});
  }
  // next question after delay (lets the glitch play)
  setTimeout(()=>{ askNext(); }, 750);
}

yesBtn.addEventListener('click', ()=>handleAnswer('YES'));
noBtn.addEventListener('click', ()=>handleAnswer('NO'));

function finalizeTransmission(){
  if(finalSequenceTriggered) return;
  finalSequenceTriggered = true;
  yesBtn.style.display = noBtn.style.display = 'none';
  qEl.innerHTML = "<strong>TRANSMISSION SEALED.</strong><br><span class='muted'>Archival echo executing... hold position.</span>";
  megaGlitchRitual();
  playSound(audioGlitch3, 1.0);
  setTimeout(()=>{
    renderTranscript();
  }, 900);
}

function megaGlitchRitual(){
  document.body.classList.add('omega-glitch');
  screen.classList.add('omega-shake');
  gScreen.style.display='block';
  sg1.style.opacity = 1;
  sg2.style.opacity = 0.85;
  setTimeout(()=>{ screen.classList.remove('omega-shake'); }, 1800);
  setTimeout(()=>{ document.body.classList.remove('omega-glitch'); }, 6200);
}

function renderTranscript(){
  transcriptOverlay.classList.add('active');
  transcriptOverlay.setAttribute('aria-hidden','false');
  transcriptBody.innerHTML = '';
  overlayScrollTriggered = false;
  transcriptBody.scrollTop = 0;
  transcriptFooter.textContent = 'SCROLL THROUGH THE LOG TO CONFIRM RETENTION.';
  finalNotice.classList.remove('revealed');
  transcriptLog.forEach((entry, idx)=>{
    const wrapper = document.createElement('div');
    wrapper.className = 'transcript-entry';
    const tag = document.createElement('div');
    tag.className = 'transcript-tag';
    tag.textContent = `EXCHANGE ${String(idx+1).padStart(2,'0')}`;
    const text = document.createElement('div');
    text.className = 'transcript-text';
    const qSpeaker = document.createElement('div');
    qSpeaker.className = 'speaker';
    qSpeaker.textContent = 'ROOM404 // QUERY';
    const qContent = document.createElement('div');
    qContent.className = 'content';
    qContent.textContent = entry.question;
    const aSpeaker = document.createElement('div');
    aSpeaker.className = 'speaker';
    aSpeaker.textContent = 'SPECIMEN // RESPONSE';
    const aContent = document.createElement('div');
    aContent.className = 'reply';
    aContent.textContent = entry.answer;
    text.appendChild(qSpeaker);
    text.appendChild(qContent);
    text.appendChild(aSpeaker);
    text.appendChild(aContent);
    wrapper.appendChild(tag);
    wrapper.appendChild(text);
    transcriptBody.appendChild(wrapper);
  });
}

/* ====== safety: ensure ambient keeps running when page regains focus ====== */
window.addEventListener('focus', ()=> {
  if(audioAmbient && audioAmbient.paused && audioCtx === null){
    audioAmbient.play().catch(()=>{});
  }
});

transcriptBody.addEventListener('scroll', ()=>{
  if(overlayScrollTriggered) return;
  const bottom = Math.ceil(transcriptBody.scrollTop + transcriptBody.clientHeight) >= transcriptBody.scrollHeight;
  if(bottom){
    overlayScrollTriggered = true;
    playSound(audioGlitch1, 1.0);
    bigGlitchVisual(true);
    transcriptFooter.textContent = 'ARCHIVE VALIDATED // SIGNAL IMMUTABLE.';
    finalNotice.classList.add('revealed');
  }
});

/* ====== preload attempt for quick startup ====== */
window.addEventListener('load', ()=> {
  // try quick load of audio resources
  [audioAmbient,audioGlitch1,audioGlitch2,audioGlitch3].forEach(a=>{ try{ a.load(); }catch(e){} });
  // hide glitch screen initially
  gScreen.style.display='none'; sg1.style.opacity=0; sg2.style.opacity=0;
});
</script>
</body>
</html>






